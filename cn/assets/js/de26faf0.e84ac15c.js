"use strict";(self.webpackChunkpendle_documentation=self.webpackChunkpendle_documentation||[]).push([[9392],{3905:(e,r,n)=>{n.d(r,{Zo:()=>p,kt:()=>h});var t=n(7294);function a(e,r,n){return r in e?Object.defineProperty(e,r,{value:n,enumerable:!0,configurable:!0,writable:!0}):e[r]=n,e}function o(e,r){var n=Object.keys(e);if(Object.getOwnPropertySymbols){var t=Object.getOwnPropertySymbols(e);r&&(t=t.filter((function(r){return Object.getOwnPropertyDescriptor(e,r).enumerable}))),n.push.apply(n,t)}return n}function i(e){for(var r=1;r<arguments.length;r++){var n=null!=arguments[r]?arguments[r]:{};r%2?o(Object(n),!0).forEach((function(r){a(e,r,n[r])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(n)):o(Object(n)).forEach((function(r){Object.defineProperty(e,r,Object.getOwnPropertyDescriptor(n,r))}))}return e}function l(e,r){if(null==e)return{};var n,t,a=function(e,r){if(null==e)return{};var n,t,a={},o=Object.keys(e);for(t=0;t<o.length;t++)n=o[t],r.indexOf(n)>=0||(a[n]=e[n]);return a}(e,r);if(Object.getOwnPropertySymbols){var o=Object.getOwnPropertySymbols(e);for(t=0;t<o.length;t++)n=o[t],r.indexOf(n)>=0||Object.prototype.propertyIsEnumerable.call(e,n)&&(a[n]=e[n])}return a}var s=t.createContext({}),c=function(e){var r=t.useContext(s),n=r;return e&&(n="function"==typeof e?e(r):i(i({},r),e)),n},p=function(e){var r=c(e.components);return t.createElement(s.Provider,{value:r},e.children)},d="mdxType",u={inlineCode:"code",wrapper:function(e){var r=e.children;return t.createElement(t.Fragment,{},r)}},m=t.forwardRef((function(e,r){var n=e.components,a=e.mdxType,o=e.originalType,s=e.parentName,p=l(e,["components","mdxType","originalType","parentName"]),d=c(n),m=a,h=d["".concat(s,".").concat(m)]||d[m]||u[m]||o;return n?t.createElement(h,i(i({ref:r},p),{},{components:n})):t.createElement(h,i({ref:r},p))}));function h(e,r){var n=arguments,a=r&&r.mdxType;if("string"==typeof e||a){var o=n.length,i=new Array(o);i[0]=m;var l={};for(var s in r)hasOwnProperty.call(r,s)&&(l[s]=r[s]);l.originalType=e,l[d]="string"==typeof e?e:a,i[1]=l;for(var c=2;c<o;c++)i[c]=n[c];return t.createElement.apply(null,i)}return t.createElement.apply(null,n)}m.displayName="MDXCreateElement"},8784:(e,r,n)=>{n.r(r),n.d(r,{assets:()=>s,contentTitle:()=>i,default:()=>u,frontMatter:()=>o,metadata:()=>l,toc:()=>c});var t=n(7462),a=(n(7294),n(3905));const o={hide_table_of_contents:!0},i="Error Handling",l={unversionedId:"Developers/SDK/ErrorHandling",id:"Developers/SDK/ErrorHandling",title:"Error Handling",description:"Overview",source:"@site/docs/Developers/SDK/ErrorHandling.md",sourceDirName:"Developers/SDK",slug:"/Developers/SDK/ErrorHandling",permalink:"/cn/Developers/SDK/ErrorHandling",draft:!1,tags:[],version:"current",frontMatter:{hide_table_of_contents:!0},sidebar:"myAutogeneratedSidebar",previous:{title:"Using Multicall",permalink:"/cn/Developers/SDK/Multicall"},next:{title:"Types and Functions",permalink:"/cn/Developers/SDK/TypesAndFunctions"}},s={},c=[{value:"Overview",id:"overview",level:2},{value:"PendleSdkError",id:"pendlesdkerror",level:2},{value:"<code>Error(message)</code> and <code>Panic(code)</code>",id:"errormessage-and-paniccode",level:2},{value:"<code>PendleContractError</code>",id:"pendlecontracterror",level:2},{value:"Catching Errors",id:"catching-errors",level:3}],p={toc:c},d="wrapper";function u(e){let{components:r,...n}=e;return(0,a.kt)(d,(0,t.Z)({},p,n,{components:r,mdxType:"MDXLayout"}),(0,a.kt)("h1",{id:"error-handling"},"Error Handling"),(0,a.kt)("h2",{id:"overview"},"Overview"),(0,a.kt)("p",null,"The Pendle SDK is based on Ethers.js, which is a very versatile library. But while handling all the interactions with smart contracts, Ethers.js' error handling process can become quite cryptic. Ethers.js native error handling does not support typing. In addition, the actual error is often nested very deeply. The Pendle SDK includes some utilities that helps aid the error handling process while interacting with the contracts."),(0,a.kt)("h2",{id:"pendlesdkerror"},"PendleSdkError"),(0,a.kt)("pre",null,(0,a.kt)("code",{parentName:"pre",className:"language-ts"},"import { PendleSdkError } from '@pendle/sdk-v2';\n")),(0,a.kt)("p",null,"This is the super class for all Error classes in Pendle SDK. It is a very simple class, its only has a constructor that accepts the error message."),(0,a.kt)("pre",null,(0,a.kt)("code",{parentName:"pre",className:"language-ts"},"try {\n  throw new PendleSdkError('Hello there');\n} catch (e) {\n  if (e instanceof PendleSdkError) {\n      console.log(e.message);\n  }\n}\n")),(0,a.kt)("p",null,"Output:"),(0,a.kt)("pre",null,(0,a.kt)("code",{parentName:"pre",className:"language-ts"},"Hello there\n")),(0,a.kt)("h2",{id:"errormessage-and-paniccode"},(0,a.kt)("inlineCode",{parentName:"h2"},"Error(message)")," and ",(0,a.kt)("inlineCode",{parentName:"h2"},"Panic(code)")),(0,a.kt)("p",null,(0,a.kt)("inlineCode",{parentName:"p"},"Error(message)`` and "),"Panic(code)` are built-in contract errors."),(0,a.kt)("pre",null,(0,a.kt)("code",{parentName:"pre",className:"language-ts"},"import { BuiltinContractError, PanicBuiltinContractError, ErrorBuiltinContractError } from '@pendle/sdk-v2';\n")),(0,a.kt)("pre",null,(0,a.kt)("code",{parentName:"pre",className:"language-ts"},"class BuiltinContractError extends PendleSdkError;\nclass ErrorBuiltinContractError extends BuiltinContractError;\nclass PanicBuiltinContractError extends BuiltinContractError;\n")),(0,a.kt)("p",null,"On the contract, there are two built-in errors: ",(0,a.kt)("inlineCode",{parentName:"p"},"Error(string message)")," and ",(0,a.kt)("inlineCode",{parentName:"p"},"Panic(uint256 code)"),". This ",(0,a.kt)("inlineCode",{parentName:"p"},"BuiltinContractError")," is the super class for ",(0,a.kt)("inlineCode",{parentName:"p"},"ErrorBuiltinContractError")," and ",(0,a.kt)("inlineCode",{parentName:"p"},"PanicBuiltinContractError")," respectively."),(0,a.kt)("pre",null,(0,a.kt)("code",{parentName:"pre",className:"language-ts"},"try {\n  // some contract operation.\n} catch (e) {\n  if (e instanceof PanicBuiltinContractError) {\n      console.log('Panic with code', e.code);\n  }\n  if (e instanceof ErrorBuiltinContractError) {\n      console.log('Error with message', e.message);\n  }\n}\n")),(0,a.kt)("h2",{id:"pendlecontracterror"},(0,a.kt)("inlineCode",{parentName:"h2"},"PendleContractError")),(0,a.kt)("p",null,(0,a.kt)("inlineCode",{parentName:"p"},"PendleContractError")," are errors from Pendle protocol contracts."),(0,a.kt)("pre",null,(0,a.kt)("code",{parentName:"pre",className:"language-ts"},"import { PendleContractError } from '@pendle/sdk-v2';\n")),(0,a.kt)("p",null,"When an error is found, Pendle contracts will thrown an Error message as defined in ",(0,a.kt)("a",{parentName:"p",href:"https://github.com/pendle-finance/pendle-core-internal-v2/blob/main/contracts/core/libraries/Errors.sol"},"this contract library"),". These errors will be wrapped into ",(0,a.kt)("inlineCode",{parentName:"p"},"PendleContractError"),". The instance of this class has two main properties:"),(0,a.kt)("ul",null,(0,a.kt)("li",{parentName:"ul"},(0,a.kt)("inlineCode",{parentName:"li"},"errorName")," - The name of the error. The type of this property is not ",(0,a.kt)("inlineCode",{parentName:"li"},"string"),", but an union of all Pendle contracts error's name for type safety. For example:",(0,a.kt)("ul",{parentName:"li"},(0,a.kt)("li",{parentName:"ul"},(0,a.kt)("inlineCode",{parentName:"li"},"'marketExpired'"),", ",(0,a.kt)("inlineCode",{parentName:"li"},"'RouterInsufficientLpOut'"),", ",(0,a.kt)("inlineCode",{parentName:"li"},"'RouterExceededLimitYtIn'"),", etc. are valid values for ",(0,a.kt)("inlineCode",{parentName:"li"},"errorName")),(0,a.kt)("li",{parentName:"ul"},(0,a.kt)("inlineCode",{parentName:"li"},"'RandomError'")," - Indicates that it is not a valid value, as it is not defined in the contracts. "))),(0,a.kt)("li",{parentName:"ul"},(0,a.kt)("inlineCode",{parentName:"li"},"args")," - The arguments passed to the Error on the contract side. You can think it like ",(0,a.kt)("inlineCode",{parentName:"li"},"any[]"),". But in reality, it is also a union of tuples of the errors' parameters. ")),(0,a.kt)("h3",{id:"catching-errors"},"Catching Errors"),(0,a.kt)("p",null,(0,a.kt)("inlineCode",{parentName:"p"},"PendleContractError")," has a method called ",(0,a.kt)("inlineCode",{parentName:"p"},"isType(errorName): PendleContractError<errorName>"),", which check if the current instance's ",(0,a.kt)("inlineCode",{parentName:"p"},"errorName")," is the same type as the passed argument. This method is a type predicate to check for both error name AND the arguments."),(0,a.kt)("p",null,"For example:"),(0,a.kt)("pre",null,(0,a.kt)("code",{parentName:"pre",className:"language-ts"},"import { BN } from '@pendle/sdk-v2';\ntry {\n    // ...\n} catch (e) {\n    if (e instanceof PendleContractError) {\n        if (e.isType('YieldContractInsufficientSy')) {\n            // e.args will now have type [BN, BN] (BN represents uint256 on the contract)\n            const actualSy: BN = e.args[0];\n            const requiredSy: BN = e.args[1];\n            console.log(actualSy.toString(), requiredSy.toString());\n        } else if (e.isType('MarketExpired')) {\n            // e.args will now have type [] (an empty tuple)\n        }\n        // ...\n    }\n}\n")))}u.isMDXComponent=!0}}]);